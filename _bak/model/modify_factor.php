<?php		header("Content-Type:text/html;charset=utf-8");	include("connect.php");	$l_name = $_POST[l_name];	$l_id = $_POST[l_id];	$uptypes = array('application/vnd.ms-excel');	$max_file_size = 20000000;	$destination_folder = '../sci_factor/';	if ($_SERVER['REQUEST_METHOD'] == 'POST') {		$info = '';		$name = null;		if (is_uploaded_file($_FILES['l_content']['tmp_name'])) {			$upfile = $_FILES['l_content'];			$name = time().$FILES['name'];			$type = $upfile['type'];						$size = $upfile['size'];			$tmp_name = $upfile['tmp_name'];			$error = $upfile['error'];			if($max_file_size<$size) {				$info='替换文件太大！不能替换！';			}			/*			if (!in_array($type,$uptypes)) {				$info = $info.' 替换文件类型不符'.$type.'不能替换';			}			*/			$type = trim(substr($type,6,12));			if ($info == '') {			    $name .= '.xls';				if (move_uploaded_file($_FILES['l_content']['tmp_name'], $destination_folder.$name)) {					$info='替换文件成功！';					$sql = "select l_content from link where l_id=$l_id";					$result = mysql_query($sql);					$row = mysql_fetch_array($result);					$old_file = '..'.substr($row[0],13);					if(file_exists($old_file)){    					unlink($old_file);					}					$l_content = "../background/sci_factor/$name";				} else {					$name=null;				}								$sql = "update link set l_name='$l_name', l_content='$l_content' where l_id=$l_id";				mysql_query($sql);				$flag = mysql_affected_rows();				if($flag == 1){				    $info .= '修改成功！';				} else {				    $info .= '修改失败！';					unlink($name);				}				echo "<script>alert('$info');parent.window.location.href='../view/modify_factor.php?id=$l_id';</script>";			} else {		        $info = '替换文件失败！';			    echo "<script>alert('$info');</script>";		    }		} else {		    $info = '未选择文件！';			echo "<script>alert('$info');</script>";		}			}?>